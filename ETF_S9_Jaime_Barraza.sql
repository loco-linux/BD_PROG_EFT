DROP TABLE PAIS CASCADE CONSTRAINTS;
DROP TABLE REGION CASCADE CONSTRAINTS;
DROP TABLE SERVICIO_LOCAL_EDUCP CASCADE CONSTRAINTS;
DROP TABLE PUEBLO_INDIGENA CASCADE CONSTRAINTS;
DROP TABLE INSTITUCION CASCADE CONSTRAINTS;
DROP TABLE PASANTIA_PERFECCIONAMIENTO CASCADE CONSTRAINTS;
DROP TABLE ANTECEDENTES_PERSONALES CASCADE CONSTRAINTS;
DROP TABLE ANTECEDENTES_LABORALES CASCADE CONSTRAINTS;
DROP TABLE POSTULACION_PASANTIA_PERFEC CASCADE CONSTRAINTS;
DROP TABLE DETALLE_PUNTAJE_POSTULACION CASCADE CONSTRAINTS;
DROP TABLE RESULTADO_POSTULACION CASCADE CONSTRAINTS;
DROP TABLE PTJE_PUEBLO_INDIGENA CASCADE CONSTRAINTS;
DROP TABLE PTJE_ZONA_RURAL CASCADE CONSTRAINTS;
DROP TABLE PTJE_ANNOS_EXPERIENCIA CASCADE CONSTRAINTS;
DROP TABLE PTJE_PAIS_POSTULA CASCADE CONSTRAINTS;
DROP TABLE ERROR_PROCESO;
DROP SEQUENCE SEQ_REGION;
DROP SEQUENCE SEQ_PAIS;
DROP SEQUENCE SEQ_INST;
DROP SEQUENCE SEQ_PAS_PER;
DROP SEQUENCE SEQ_SERV_EDUP;
DROP SEQUENCE SEQ_ERROR;

CREATE SEQUENCE SEQ_SERV_EDUP START WITH 10 INCREMENT BY 10;
CREATE SEQUENCE SEQ_REGION;
CREATE SEQUENCE SEQ_PAS_PER START WITH 1000 INCREMENT BY 1;
CREATE SEQUENCE SEQ_PAIS START WITH 10 INCREMENT BY 1;
CREATE SEQUENCE SEQ_INST START WITH 5 INCREMENT BY 5;
CREATE SEQUENCE SEQ_ERROR;

CREATE TABLE PAIS
(cod_pais NUMBER(3) NOT NULL,
 nombre_pais VARCHAR2(30) NOT NULL,
 CONSTRAINT PK_PAIS PRIMARY KEY(cod_pais));
 
CREATE TABLE REGION
(cod_region  NUMBER(3) NOT NULL,
 nombre_region VARCHAR2(50) NOT NULL,
 CONSTRAINT PK_REGION PRIMARY KEY(cod_region));  

CREATE TABLE PUEBLO_INDIGENA
(cod_pueblo_ind  NUMBER(4) NOT NULL,
 nombre_pueblo_ind VARCHAR2(50) NOT NULL,
 CONSTRAINT PK_PUEBLOS_INDIG PRIMARY KEY(cod_pueblo_ind));  
 
CREATE TABLE SERVICIO_LOCAL_EDUCP
(cod_serv_educp NUMBER(5) NOT NULL,
 desc_serv_educp VARCHAR2(50) NOT NULL,
 zona_rural NUMBER(2),
 cod_region  NUMBER(3) NOT NULL,
 CONSTRAINT PK_SERV_LOCAL_EDUCP PRIMARY KEY(cod_serv_educp),
 CONSTRAINT FK_SERV_LOCALEP_REGION FOREIGN KEY(cod_region) REFERENCES REGION(cod_region));
 
CREATE TABLE ANTECEDENTES_PERSONALES
(numrun NUMBER (8) NOT NULL,
dvrun VARCHAR (1) NOT NULL,
pnombre VARCHAR2 (15) NOT NULL,
snombre VARCHAR2 (15),
apaterno VARCHAR2 (15) NOT NULL,
amaterno VARCHAR2 (15) NOT NULL,
fecha_nacimiento DATE NOT NULL,
telefono_contacto NUMBER (11),
cod_pueblo_ind NUMBER (4),
CONSTRAINT PK_ANT_PERSONALES PRIMARY KEY(numrun),
CONSTRAINT FK_ANT_PER_PIND FOREIGN KEY(cod_pueblo_ind) REFERENCES PUEBLO_INDIGENA(cod_pueblo_ind)); 

CREATE TABLE ANTECEDENTES_LABORALES
(numrun NUMBER (8) NOT NULL,
 fecha_contrato DATE NOT NULL,
 horas_semanales NUMBER(2) NOT NULL,
 establecimiento VARCHAR2(80) NOT NULL,
 cod_serv_educp NUMBER(5) NOT NULL,
 CONSTRAINT PK_ANT_LABORALES PRIMARY KEY(numrun,fecha_contrato),
 CONSTRAINT FK_ANT_LAB_ANT_PER FOREIGN KEY(numrun) REFERENCES ANTECEDENTES_PERSONALES(numrun),
 CONSTRAINT FK_ANT_LAB_SERVEDUCP FOREIGN KEY(cod_serv_educp) REFERENCES SERVICIO_LOCAL_EDUCP(cod_serv_educp));

CREATE TABLE INSTITUCION
(cod_inst NUMBER(4) NOT NULL,
 nombre_inst VARCHAR2(60) NOT NULL,
 cod_pais NUMBER(3),
 CONSTRAINT PK_INSTITUCION PRIMARY KEY(cod_inst),
 CONSTRAINT FK_INST_PAIS FOREIGN KEY(cod_pais) REFERENCES PAIS(cod_pais));
 
CREATE TABLE PASANTIA_PERFECCIONAMIENTO
(cod_programa NUMBER(7) NOT NULL,
 desc_programa VARCHAR2(120) NOT NULL,
 cod_inst NUMBER(4) NOT NULL,
 CONSTRAINT PK_PROG_ESP PRIMARY KEY(cod_programa),
 CONSTRAINT FK_PROG_ESP_INST FOREIGN KEY(cod_inst) REFERENCES INSTITUCION(cod_inst));
 
CREATE TABLE POSTULACION_PASANTIA_PERFEC
(numrun NUMBER (8) NOT NULL,
cod_programa NUMBER(7) NOT NULL,
fecha_inicio DATE NOT NULL,
fecha_termino DATE NOT NULL,
CONSTRAINT PK_POST_PROG_ESP PRIMARY KEY(numrun),
CONSTRAINT FK_POST_PROG_ESP_ANTPER FOREIGN KEY(numrun) REFERENCES ANTECEDENTES_PERSONALES(numrun),
CONSTRAINT FK_POST_PROG_ESP_PROG FOREIGN KEY(cod_programa) REFERENCES PASANTIA_PERFECCIONAMIENTO(cod_programa));

CREATE TABLE DETALLE_PUNTAJE_POSTULACION
(run_postulante VARCHAR2(13) NOT NULL,
 nombre_postulante VARCHAR2(60) NOT NULL,
 ptje_annos_exp NUMBER(4) NOT NULL,
 ptje_pais_postula NUMBER(4) NOT NULL,
 ptje_extra  NUMBER(4) NOT NULL,
 CONSTRAINT PK_DET_PTJE_POST PRIMARY KEY(run_postulante));
 
CREATE TABLE RESULTADO_POSTULACION
(run_postulante VARCHAR2(13) NOT NULL,
 ptje_final_post NUMBER(6) NOT NULL,
 resultado_post VARCHAR2(20) NOT NULL,
 CONSTRAINT PK_RESULT_POST PRIMARY KEY(run_postulante));
 
CREATE TABLE ERROR_PROCESO
(numrun NUMBER(8) NOT NULL,
 rutina_error VARCHAR2(100) NOT NULL, 
 mensaje_error VARCHAR(250) NOT NULL,
 CONSTRAINT PK_ERROR_PROCESO PRIMARY KEY(numrun));
 
CREATE TABLE PTJE_ZONA_RURAL
(zona_rural_ini NUMBER(2) NOT NULL,
 zona_rural_ter NUMBER(2) NOT NULL,
 ptje_zrural NUMBER(4) NOT NULL,
 CONSTRAINT PK_PTJE_ZONA_RURAL PRIMARY KEY(zona_rural_ini));
 
 CREATE TABLE PTJE_PUEBLO_INDIGENA
(cod_pueblo_ind  NUMBER(4) NOT NULL,
 ptje_pueblo_ind NUMBER(4) NOT NULL,
 CONSTRAINT PK_PTJE_OUEBLO_IND PRIMARY KEY(cod_pueblo_ind));
 
CREATE TABLE PTJE_ANNOS_EXPERIENCIA
(rango_annos_ini NUMBER(2) NOT NULL,
 rango_annos_ter NUMBER(2) NOT NULL,
 ptje_experiencia NUMBER(4) NOT NULL,
 CONSTRAINT PK_PTJE_ANNOS_EXP PRIMARY KEY(rango_annos_ini));

 CREATE TABLE PTJE_PAIS_POSTULA
(cod_pais NUMBER(3) NOT NULL,
 ptje_pais NUMBER(4) NOT NULL,
 CONSTRAINT PK_PTJE_PAIS_POST PRIMARY KEY(cod_pais));
 
 
 
INSERT INTO PTJE_PUEBLO_INDIGENA VALUES(200,1010);
INSERT INTO PTJE_PUEBLO_INDIGENA VALUES(300,1020);
INSERT INTO PTJE_PUEBLO_INDIGENA VALUES(400,1030);
INSERT INTO PTJE_PUEBLO_INDIGENA VALUES(500,1040);
INSERT INTO PTJE_PUEBLO_INDIGENA VALUES(600,1050);
INSERT INTO PTJE_PUEBLO_INDIGENA VALUES(700,1060);
INSERT INTO PTJE_PUEBLO_INDIGENA VALUES(800,1055);
INSERT INTO PTJE_PUEBLO_INDIGENA VALUES(900,1070);
INSERT INTO PTJE_PUEBLO_INDIGENA VALUES(1000,1080); 

INSERT INTO PTJE_ANNOS_EXPERIENCIA VALUES(3,10,1000);
INSERT INTO PTJE_ANNOS_EXPERIENCIA VALUES(11,15,1010);
INSERT INTO PTJE_ANNOS_EXPERIENCIA VALUES(16,20,1020);
INSERT INTO PTJE_ANNOS_EXPERIENCIA VALUES(21,23,1030);
INSERT INTO PTJE_ANNOS_EXPERIENCIA VALUES(24,26,1040);
INSERT INTO PTJE_ANNOS_EXPERIENCIA VALUES(27,30,1050);
INSERT INTO PTJE_ANNOS_EXPERIENCIA VALUES(31,35,1100);
INSERT INTO PTJE_ANNOS_EXPERIENCIA VALUES(36,40,1200);
 
INSERT INTO PTJE_ZONA_RURAL VALUES(1,4,1020);
INSERT INTO PTJE_ZONA_RURAL VALUES(5,6,1000);
INSERT INTO PTJE_ZONA_RURAL VALUES(7,9,1010);
INSERT INTO PTJE_ZONA_RURAL VALUES(10,12,1030);
INSERT INTO PTJE_ZONA_RURAL VALUES(13,15,1040);
INSERT INTO PTJE_ZONA_RURAL VALUES(16,18,1050); 
 
INSERT INTO PTJE_PAIS_POSTULA VALUES(10,1050);
INSERT INTO PTJE_PAIS_POSTULA VALUES(11,1010);
INSERT INTO PTJE_PAIS_POSTULA VALUES(12,1040);
INSERT INTO PTJE_PAIS_POSTULA VALUES(13,1020);
INSERT INTO PTJE_PAIS_POSTULA VALUES(14,1030);
INSERT INTO PTJE_PAIS_POSTULA VALUES(15,1060);
INSERT INTO PTJE_PAIS_POSTULA VALUES(16,1000);
 
INSERT INTO PAIS VALUES(SEQ_PAIS.NEXTVAL,'ALEMANIA');
INSERT INTO PAIS VALUES(SEQ_PAIS.NEXTVAL,'BRASIL');
INSERT INTO PAIS VALUES(SEQ_PAIS.NEXTVAL,'CANADA');
INSERT INTO PAIS VALUES(SEQ_PAIS.NEXTVAL,'ESPAÑA');
INSERT INTO PAIS VALUES(SEQ_PAIS.NEXTVAL,'ESTADOS UNIDOS');
INSERT INTO PAIS VALUES(SEQ_PAIS.NEXTVAL,'FINLANDIA');
INSERT INTO PAIS VALUES(SEQ_PAIS.NEXTVAL,'MEXICO'); 

INSERT INTO INSTITUCION VALUES(SEQ_INST.NEXTVAL,'Technical University of Munich',10);
INSERT INTO INSTITUCION VALUES(SEQ_INST.NEXTVAL,'Ruhr-University of Bochum',10);
INSERT INTO INSTITUCION VALUES(SEQ_INST.NEXTVAL,'University of Stuttgart',10);
INSERT INTO INSTITUCION VALUES(SEQ_INST.NEXTVAL,'UFAM',11);
INSERT INTO INSTITUCION VALUES(SEQ_INST.NEXTVAL,'Instituto Nacional de Telecomunicaciones',11);
INSERT INTO INSTITUCION VALUES(SEQ_INST.NEXTVAL,'University of Lethbridge',12);
INSERT INTO INSTITUCION VALUES(SEQ_INST.NEXTVAL,'University of Toronto',12);
INSERT INTO INSTITUCION VALUES(SEQ_INST.NEXTVAL,'Goierri Eskola',13);
INSERT INTO INSTITUCION VALUES(SEQ_INST.NEXTVAL,'Centro Superior de Estudios Universitarios La Salle',13);
INSERT INTO INSTITUCION VALUES(SEQ_INST.NEXTVAL,'Fundación Zubigune',13);
INSERT INTO INSTITUCION VALUES(SEQ_INST.NEXTVAL,'TKNIKA Centro de Innovación para la Fomación Profesional',13);
INSERT INTO INSTITUCION VALUES(SEQ_INST.NEXTVAL,'Universidad Autónoma de Barcelona',13);
INSERT INTO INSTITUCION VALUES(SEQ_INST.NEXTVAL,'Florida Christian University',14);
INSERT INTO INSTITUCION VALUES(SEQ_INST.NEXTVAL,'Georgia Southern University',14);
INSERT INTO INSTITUCION VALUES(SEQ_INST.NEXTVAL,'University of Pittsburgh School of Education',14);
INSERT INTO INSTITUCION VALUES(SEQ_INST.NEXTVAL,'Borgå Medborgarinstitut', 15);
INSERT INTO INSTITUCION VALUES(SEQ_INST.NEXTVAL,'Escalae Academy',15);
INSERT INTO INSTITUCION VALUES(SEQ_INST.NEXTVAL,'Tecnológico de Monterrey',16);
INSERT INTO INSTITUCION VALUES(SEQ_INST.NEXTVAL,'Instituto Tecnólogico y de Estudios Superiores de Monterrey',16);
INSERT INTO INSTITUCION VALUES(SEQ_INST.NEXTVAL,'Universidad Intercontinental', 16);
INSERT INTO INSTITUCION VALUES(SEQ_INST.NEXTVAL,'Universidad Tecnológica Americana (UTECA))', 16);


INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Neurodidáctica para el aula: el proceso de enseñanza aprendizaje',10);
INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Aprendizaje Colaborativo Basado en Desafíos',50);
INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Aprendizaje basado en Proyectos y Problemas para el desarrollo de habilidades cognitivas superiores',95);
INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Competencias Prácticas y de Innovación en Educación de Párvulos',30);
INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Desarrollo de Competencias para la Docencia en Educación Media Técnico Profesional',40);
INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Articulación de asignaturas como estrategia para el desarrollo de habilidades cognitivas en el aula',70);
INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Metodologías Didácticas para la Enseñana de Nivel Pre-Escolar ',15);
INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Metodologías Didácticas para la Enseñana de Nivel Media',20);
INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Mecatrónica',35);
INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Inteligencia Emocional en Nivel Pre-Escolar',55);
INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Desarrollo de Habilidades del Lenguaje',45);
INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Neurología Aplicada para le Diagnóstico de TEA',55);
INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Tecnología Informática Aplicada en la Educación',25);
INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Telecomunicaciones y Admistración de Redes',90);
INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Gestión de Proyectos Educativos para la Innovación Educativa',45);
INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Autotrónica Aplicada',5);
INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Matemática Aplicada en el Desarrollo de Habilidades de la Lógica para la Informática',60);
INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Innovación en el Leguaje de Señas',65);
INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Construcciones Metálicas',35);
INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Mecánica Industrial y Electricidad',35);
INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Estrategias para la Implementación del Trabajo en Equipo en el Aula',75);
INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Desarrollo de Competencias para la Docencia en EMTP',80);
INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Magíster en Dirección y Gestión Escolar',85);
INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Maestría Tecnología Educativa y Competencias Digitales',100);
INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Postítulo en Pedagogía de Educación de Enseñanza Media',10);
INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Perfeccionamiento para Docentes EMTP en Agricultura, Horticultura y Viticultura',40);
INSERT INTO PASANTIA_PERFECCIONAMIENTO VALUES(SEQ_PAS_PER.NEXTVAL,'Desarrollo de Aplicaciones en Python',105);

INSERT INTO REGION VALUES(SEQ_REGION.NEXTVAL,'Arica y Parinacota');
INSERT INTO REGION VALUES(SEQ_REGION.NEXTVAL,'Tarapacá');
INSERT INTO REGION VALUES(SEQ_REGION.NEXTVAL,'Antofagasta');
INSERT INTO REGION VALUES(SEQ_REGION.NEXTVAL,'Atacama');
INSERT INTO REGION VALUES(SEQ_REGION.NEXTVAL,'Coquimbo');
INSERT INTO REGION VALUES(SEQ_REGION.NEXTVAL,'Valparaíso');
INSERT INTO REGION VALUES(SEQ_REGION.NEXTVAL,'Metropolitana');
INSERT INTO REGION VALUES(SEQ_REGION.NEXTVAL,'O'|| ''''||'Higgins');
INSERT INTO REGION VALUES(SEQ_REGION.NEXTVAL,'Maule');
INSERT INTO REGION VALUES(SEQ_REGION.NEXTVAL,'Ñuble');
INSERT INTO REGION VALUES(SEQ_REGION.NEXTVAL,'Bío-Bío');
INSERT INTO REGION VALUES(SEQ_REGION.NEXTVAL,'La Araucanía');
INSERT INTO REGION VALUES(SEQ_REGION.NEXTVAL,'Los Ríos');
INSERT INTO REGION VALUES(SEQ_REGION.NEXTVAL,'Los Lagos');
INSERT INTO REGION VALUES(SEQ_REGION.NEXTVAL,'Aysén');
INSERT INTO REGION VALUES(SEQ_REGION.NEXTVAL,'Magallanes');

INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Arica',NULL,1);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Chinchorro',1,1);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Iquique',NULL,2);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Tamarugal',2,2);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Antofagasta',NULL,3);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Atacama',NULL,4);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Huasco',3,4);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Elqui',NULL,5);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Puerto Cordillera',NULL,5);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Limarí y Choapa',NULL,5);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Valparaíso',NULL,6);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Hanga Roa',4,6);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Costa Central',NULL,6);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Valle',NULL,6);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Santiago Centro',NULL,7);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Santiago Sur',NULL,7);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Santiago Sur-Oriente',NULL,7);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Santiago Oriente',NULL,7);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Santiago Norte',NULL,7);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Santiago Occidente',NULL,7);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Colchagua',5,8);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Valle Cachapoal',6,8);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Cachapoal Costa',7,8);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Maule Costa',NULL,9);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Los Cerezos',NULL,9);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Los Álamos',8,9);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Maule Valle',NULL,9);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Valle Diguillín',NULL,10);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Costa Itata',9,10);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Punilla Cordillera',10,10);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Andalién',NULL,11);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Puelche',11,11);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Arauco',12,11);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Biobío',NULL,11);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Malleco Costa',NULL,12);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Costa Araucanía',13,12);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Malleco Cordillera',14,12);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Ranco',15,13);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Valdivia',NULL,13);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Llanquihue',NULL,14);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Chiloé',16,14);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Aysén',17,15);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Magallanes Valle',NULL,16);
INSERT INTO SERVICIO_LOCAL_EDUCP VALUES(SEQ_SERV_EDUP.NEXTVAL,'Magallanes Sur',18,16);
 
INSERT INTO PUEBLO_INDIGENA VALUES(100,'Aymara');
INSERT INTO PUEBLO_INDIGENA VALUES(200,'Atacameño o Likan Antai');
INSERT INTO PUEBLO_INDIGENA VALUES(300,'Quechua');
INSERT INTO PUEBLO_INDIGENA VALUES(400,'Collas');
INSERT INTO PUEBLO_INDIGENA VALUES(500,'Changos');
INSERT INTO PUEBLO_INDIGENA VALUES(600,'Diaguitas');
INSERT INTO PUEBLO_INDIGENA VALUES(700,'Rapanui');
INSERT INTO PUEBLO_INDIGENA VALUES(800,'Mapuche');
INSERT INTO PUEBLO_INDIGENA VALUES(900,'Kawésqar');
INSERT INTO PUEBLO_INDIGENA VALUES(1000,'Yagán');

INSERT INTO ANTECEDENTES_PERSONALES VALUES('14405525','1','CARLOS','JOEL','MAMANI','RIOS','23/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-47),56943757343,100);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('9074609','1','AXEL','MIGUEL','GUZMAN','HOGGER','23/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-56),56986067331,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('9053149','4','ALVARO','RODRIGO','CHURATUPA','MONCADA','09/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-57),56960882196,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('22424126','9','NICOLÁS','JUAN','DOMINGUEZ','AYMANI','28/07/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-27),56937479887,200);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('21037594','7','ANDREA',null,'LOPEZ','GUAJARDO','20/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-33),56937479884,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('22176845','2','SILVANA','MARTINA','VALENZUELA','DUARTE','06/01/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-28),56918781007,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('7455786','6','ANDREA','PAZ','GUAJARDO','ROMERO','01/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-67),56932544703,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('6889506','7','JOAQUIN','CARLOS','SALGADO','GUTIERREZ','09/09/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-60),56932263754,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('10534912','4','CATALINA','SOFIA','PEREIRA','AGUIRRE','17/02/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-53),56954933889,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('15583473','2','RICARDO','ALEX','ARIAS','AMARU','12/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-44),56954216826,300);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('21454912','5','JOSE','MIGUEL','TAPIA','TOBAR','12/09/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-28),56937342030,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('7467776','4','FELIPE','CRISTIAN','MARIN','GONZALEZ','07/09/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-60),56991869103,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('21281336','4','ANTONELLA',null,'GUZMAN','ALVARADO','12/12/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-29),56935221206,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('14415536','1','FABIOLA','ANDREA','SILVA','MENESES','06/01/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-46),56939539356,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('7035298','4','DORIS','YANINA','ARREDONDO','QUILPATAY','23/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-60),56970510282,600);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('22558062','8','AMANDA','FABIOLA','MARAMBIO','LIZANA','23/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-26),56948576648,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('16000473','k','ROBERTO','DANIEL','GIRARDI','MENDEZ','20/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-42),56995507317,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('6433226','2','BELEN','JACQUELINE','SEPULVEDA','FIGUEROA','01/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-60),56921581272,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('6918259','5','DENISSE','ALEJANDRA','SMITH','MARDONES','30/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-60),56916304907,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('17471611','5','CLAUDIA',null,'TUKI','TEPANOo','12/12/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-30),56982239447,700);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('23309887','8','HECTOR','FRANCISCO','TOLOZA','CONTRERAS','23/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-27),56952406038,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('18333033','5','RODOLFO','CRISTIAN','OTAROLA','FRITZ','20/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-35),56929544102,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('20866870','2','ANDRES','LUIS','CONTRERAS','MORALES','12/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-32),56974126261,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('22503815','7','JULIAN','CARLOS','LUJAN','ARRIAGADA','21/12/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-29),56974063821,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('21300629','2','LUIS',null,'JORQUERA','LUNA','16/04/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-29),56974063823,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('24617341','0','KATHERINE','ROSA','ESTRADA','CAYMANQUI','16/04/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-27),56976838621,600);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('9575921','3','MARIA','EUGENIA','RAPU','ESCOBAR','09/09/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-55),56974563821,700);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('12173454','2','VIVIANA','ANDREA','GODOY','GALDAMES','12/12/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-50),56973814523,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('18274954','2','CAROLINA','AMANDA','BLANCO','SILVA','12/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-32),56973814526,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('12362093','5','SANDRA','LORENA','FALCON','AGUILAR','16/04/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-50),56973814529,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('6604005','6','CRISTIAN','JUAN','VALDES','RODRIGUEZ','10/09/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-72),56973814522,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('21713768','5','RODRIGO','FREDY','BERNAL','PARRA','23/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-29),56973811523,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('10964218','7','PATRICIO','ARNOLDO','VIDAL','PRADENAS','12/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-52),56973812523,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('21425049','9','SEBASTIAN',null,'BERRIOS','QUINTANA','24/09/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-29),56973813523,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('6969890','1','FERNANDO','RAFAEL','CARVAJAL','BUGUEÑO','21/12/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-60),56973816523,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('21487946','k','CARLOS','RAFAEL','REIMAN','HUILCAMAN','09/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-28),56973817523,800);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('19348481','8','SEBASTIAN','NICOLAS','RETAMAL','DIAZ','19/12/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-30),56984907703,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('12084103','5','JOSE','MIGUEL','CANDIA','QUIROZ','07/09/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-51),56984907705,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('14286265','6','ALEXIS','FERNANDO','CONTRERAS','CONA','01/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-49),56984907707,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('17024035','0','LEONARDO','ANDRES','AREVALO','DUARTE','23/06/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-37),56984907709,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('18936555','3','PAOLA','MARGARITA','OJEDA','SIEBERT','30/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-31),56982007703,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('22725178','8','XIMENA','MARCELA','PEREZ','URRUTIA','01/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-27),56983007703,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('9043492','8','FRANCISCA','PAULA',' HUENULEF','CASTRO','12/09/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-58),56984007703,800);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('10105554','1','ALICIA','NANCY','SEPULVEDA','SALDIVAR','28/07/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-54),56985007703,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('14439731','4','ELSA','MARIA','ARAVENA','GOMEZ','21/12/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-45),56986007703,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('15583472','2','RICARDO','JUAN','FERNANDEZ','ARIAS','23/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-44),56987007703,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('19348480','8','SEBASTIAN','MANUEL','DIAZ','RETAMAL','28/07/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-31),56988007703,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('9575920','3','MARIA','EUGENIA','ESCOBAR','PAILLAHUEQUE','20/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-56),56977918239,800);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('23552593','3','SANDRA','JIMENA','HERNANDEZ','CAVIERES','12/12/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-27),56987653212,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('17046056','3','MARCIA','PAULA','SIERRA','BENITEZ','01/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-36),56987654576,NULL);
INSERT INTO ANTECEDENTES_PERSONALES VALUES('10238016','9','MARLENE',null,'MONDEJA','BARROS','19/12/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-54),56987654776,NULL);


INSERT INTO  ANTECEDENTES_LABORALES VALUES('14405525','21/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-26),25,'Liceo Politécnico (A-2)',10);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('14405525','01/02/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-18),15,'Liceo Bicentenario Pablo Neruda',10);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('9074609','23/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-27),20,'Escuela Los Álamos',20);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('9074609','23/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-29),10,'Liceo Técnico Profesional Granaderos de Putre',20);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('9053149','09/05/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-28),15,'Escuela Gabriela Mistral',50);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('22424126','24/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-2),30,'Liceo Tecnológico de Copiapó',60);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('21037594','04/07/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-2),35,'Liceo Alto del Carmen',70);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('22176845','15/05/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-2),30,'Colegio Gregorio Cordovez ',80);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('7455786','27/09/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-30),27,'Instituto Superior de Comercio',90);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('6889506','02/06/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-33),20,'Liceo Bicentenario Alejandro Álvarez Jofré',100);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('10534912','20/04/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-25),15,'Liceo Eduardo de la Barra',110);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('15583473','11/12/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-25),28,'Liceo Guillermo Rivera Cotapo',130);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('21454912','25/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-5),10,'Liceo José Francisco Vergara',130);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('7467776','05/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-28),20,'Instituto Nacional',150);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('7467776','05/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-19),10,'Escuela Tomás Vargas y Arcaya',160);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('21281336','11/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-5),30,'Escuela Oscar Bonilla',170);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('21281336','07/12/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-5),10,'Liceo Arturo Alessandri Palma)',170);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('14415536','17/11/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-15),35,'Escuela Basica Unesco',180);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('7035298','19/02/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-19),10,'Liceo Bicentenario Politécnico San Joaquín',190);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('22558062','07/12/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-9),20,'Liceo Municipal de Santa Cruz',200);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('22558062','07/12/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-7),12,'Instituto Politécnico',200);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('16000473','14/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-27),30,'Liceo Requinoa',220);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('6433226','16/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-20),28,'Liceo Jean Buchaman de Larrain',230);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('6918259','23/06/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-29),20,'Liceo Antonio Varas',240);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('17471611','28/07/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-15),40,'Jardín Infantil Umanga Riki Riki',120);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('23309887','15/12/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-9),20,'Liceo Iindustrial de San Fernando',210);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('18333033','16/04/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-23),28,'Escuela el Porvenir',250);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('20866870','27/01/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-12),20,'Liceo Politécnico de Linares',260);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('20866870','27/01/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-9),15,'Liceo Valentín Letelier',260);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('22503815','12/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-22),28,'Liceo Bicentenario Oriente de Talca',270);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('21300629','03/05/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-25),30,'Liceo República de Italia Arturo Bonemetti Broggie',280);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('24617341','15/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-29),28,'Escuela Básica Alto de Piedra',290);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('9575921','20/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-27),30,'Liceo Politécnico José Manuel Pinto Arias',300);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('12173454','29/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-16),12,'Colegio Juan Gregorio Las Heras',310);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('12173454','15/12/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-29),28,'Colegio Politécnico Víctor Jara',310);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('18274954','01/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-24),38,'Liceo Miguel Ángel Cerda Leiva Mulchén',320);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('12362093','05/05/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-24),20,'Escuela de Isla Mocha',330);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('6604005','10/07/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-24),18,'Liceo Comercial Pofresor Sergio Moraga Arcil',340);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('21713768','10/05/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-5),23,'Colegio Trarulemu',350);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('21713768','16/04/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-9),17,'Colegio María Sylvester Rasch',350);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('10964218','02/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-24),20,'Escuela Aant-Lafquen',360);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('10964218','27/01/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-23),20,'Escuela el Sembrador',360);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('21425049','28/07/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-7),25,'Escuela Básica Collico',370);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('6969890','12/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-12),35,'Escuela Básica José M. Balmaceda F.',380);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('21487946','03/05/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-5),20,'Colegio Marcela Paz',390);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('21487946','03/05/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-6),10,'Escuela Alemania',390);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('19348481','15/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-19),10,'Liceo Municipal Técnico Holanda',400);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('12084103','20/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-17),20,'Liceo Politécnico de Castro',410);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('12084103','20/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-15),20,'Liceo Francisco Coloane',410);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('14286265','29/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-26),30,'Escuela Rural Curahue',410);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('17024035','22/05/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-14),25,'Escuela Aysen',420);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('17024035','22/05/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-13),15,'Escuela Básica Ribera Sur',420);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('18936555','05/05/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-17),20,'Instituto Superior de Comercio José Menendez',430);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('22725178','10/07/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-4),30,'Escuela Básica la Tirana',40);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('9043492','10/05/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-25),8,'Liceo Luis Alberto Barrera',430);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('10105554','02/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-24),18,'Escuela Rural Cerro Guido',440);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('14439731','28/07/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-20),10,'Liceo Polivalente Hernando de Magallanes',440);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('15583472','27/01/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-21),18,'Liceo Estación Central',150);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('19348480','14/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-17),15,'Escuela Básica Quile',290);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('9575920','15/12/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-19),25,'Escuela Alhuelemu',320);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('23552593','16/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-3),10,'Colegio San Francisco del Alba)',180);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('23552593','01/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-8),8,'Liceo Juan Pablo II de las Condes',180);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('17046056','23/06/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-19),15,'Liceo Bicentenario Insular)',410);
INSERT INTO  ANTECEDENTES_LABORALES VALUES('10238016','16/04/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)-33),30,'Liceo Aalcalde Sergio González Gutierrez',40);

INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(14405525,1004,'01/04/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'05/06/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(9074609,1000,'01/04/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'05/12/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(9053149,1007,'06/07/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'30/11/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(22424126,1005,'06/07/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'30/11/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(21037594,1021,'04/04/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'24/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(22176845,1011,'04/04/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'24/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(7455786,1014,'18/04/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'21/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(6889506,1022,'01/04/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'17/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(10534912,1024,'06/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'19/12/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(15583473,1002,'04/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'14/07/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(21454912,1005,'04/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'14/07/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(7467776,1001,'18/04/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'21/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(21281336,1010,'21/01/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'12/07/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(14415536,1017,'21/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'12/09/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(7035298,1018,'12/05/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'12/09/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(22558062,1019,'12/05/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'12/09/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(16000473,1024,'06/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'06/12/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(6433226,1023,'06/01/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'12/05/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(6918259,1014,'01/06/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'31/10'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(17471611,1009,'27/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'27/07'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(23309887,1008,'27/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'28/01'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+2));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(18333033,1025,'20/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'28/09'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(20866870,1026,'07/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'08/07'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(22503815,1022,'07/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'08/07'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(21300629,1016,'07/05/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'29/09/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(24617341,1007,'04/09/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'29/12/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(9575921,1003,'27/05/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'07/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(12173454,1013,'27/05/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'07/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(18274954,1002,'19/05/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'18/09/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(12362093,1005,'22/06/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'25/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(6604005,1007,'22/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'23/12/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(21713768,1012,'04/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'23/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(10964218,1007,'22/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'23/12/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(21425049,1007,'22/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'23/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(6969890,1010,'22/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'23/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(21487946,1014,'17/06/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'23/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+2));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(19348481,1015,'17/06/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'23/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+2));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(12084103,1004,'22/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'23/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(14286265,1025,'16/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'15/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(17024035,1011,'16/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'15/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(18936555,1001,'22/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'23/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(22725178,1000,'22/07/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'24/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(9043492,1012,'13/04/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'04/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(10105554,1023,'19/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'27/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(14439731,1013,'13/04/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'04/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(15583472,1022,'22/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'23/12/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(19348480,1017,'12/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'23/02/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+2));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(9575920,1006,'08/03/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'23/10/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(23552593,1001,'03/08/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'23/02/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+2));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(17046056,1023,'23/04/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'23/11/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
INSERT INTO  POSTULACION_PASANTIA_PERFEC VALUES(10238016,1024,'09/04/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1),'10/09/'||TO_CHAR(EXTRACT(YEAR FROM SYSDATE)+1));
COMMIT;



-------------------------------
--      ETF JAIME BARRAZA    --
-------------------------------


SET SERVEROUTPUT ON;



-----------------------------------------------------
-- ESPECIFICACIÓN DEL PACKAGE: PKG_PUNTAJE_EXTRA
-----------------------------------------------------
CREATE OR REPLACE PACKAGE PKG_PUNTAJE_EXTRA AS
    V_PUNTAJE_EXTRA NUMBER(10); -- Variable global para almacenar el puntaje extra calculado
    FUNCTION FN_CALC_PUNTAJE_EXTRA(
        P_SUMA_PUNTAJES IN NUMBER,
        P_HORAS_TOTALES IN NUMBER,
        P_NUM_ESTAB     IN NUMBER,
        P_PORCENTAJE    IN NUMBER
    ) RETURN NUMBER;
END PKG_PUNTAJE_EXTRA;
/

-----------------------------------------------------
-- CUERPO DEL PACKAGE: PKG_PUNTAJE_EXTRA
-----------------------------------------------------
CREATE OR REPLACE PACKAGE BODY PKG_PUNTAJE_EXTRA AS
    FUNCTION FN_CALC_PUNTAJE_EXTRA(
        P_SUMA_PUNTAJES IN NUMBER,
        P_HORAS_TOTALES IN NUMBER,
        P_NUM_ESTAB     IN NUMBER,
        P_PORCENTAJE    IN NUMBER
    ) RETURN NUMBER IS
    BEGIN
        -- Si hay más de 1 establecimiento y más de 30 horas totales, se aplica el porcentaje a la suma de puntajes
        IF (P_NUM_ESTAB > 1 AND P_HORAS_TOTALES > 30) THEN
            RETURN ROUND(P_SUMA_PUNTAJES * (P_PORCENTAJE / 100));
        ELSE
            RETURN 0;
        END IF;
    END FN_CALC_PUNTAJE_EXTRA;
END PKG_PUNTAJE_EXTRA;
/


-----------------------------------------------------
-- FUNCION: FN_FORMAT_RUT
-----------------------------------------------------
CREATE OR REPLACE FUNCTION FN_FORMAT_RUT(
    p_numrun IN VARCHAR2,
    p_dvrun  IN VARCHAR2
) RETURN VARCHAR2 IS
    v_run_limpio     VARCHAR2(20); -- Relleno del RUN a 8 dígitos
    v_run_formateado VARCHAR2(20); -- RUN formateado con puntos y guion
BEGIN
    v_run_limpio := LPAD(p_numrun, 8, '0');
    v_run_formateado := SUBSTR(v_run_limpio, 1, 2) || '.' ||
                        SUBSTR(v_run_limpio, 3, 3) || '.' ||
                        SUBSTR(v_run_limpio, 6, 3) || '-' || p_dvrun;
    RETURN v_run_formateado;
END;
/


-----------------------------------------------------
-- FUNCIÓN: FN_PUNTAJE_EXPERIENCIA
-----------------------------------------------------
CREATE OR REPLACE FUNCTION FN_PUNTAJE_EXPERIENCIA(
    P_NUMRUN IN VARCHAR2
) RETURN NUMBER IS
    V_EARLIEST_DATE DATE;
    V_ANIOS         NUMBER(2);
    V_PUNTAJE       NUMBER(10) := 0;
BEGIN
    -- Obtener la fecha de contrato más antigua
    SELECT MIN(FECHA_CONTRATO)
      INTO V_EARLIEST_DATE
      FROM ANTECEDENTES_LABORALES
     WHERE NUMRUN = P_NUMRUN;
      
    -- Calcular los años de experiencia
    V_ANIOS := FLOOR(MONTHS_BETWEEN(SYSDATE, V_EARLIEST_DATE) / 12);
        
    -- Obtener el puntaje según los años de experiencia
    SELECT A.PTJE_EXPERIENCIA
      INTO V_PUNTAJE
      FROM PTJE_ANNOS_EXPERIENCIA A
     WHERE V_ANIOS BETWEEN A.RANGO_ANNOS_INI AND A.RANGO_ANNOS_TER;
     
    RETURN V_PUNTAJE;
    
EXCEPTION
    WHEN NO_DATA_FOUND THEN
         INSERT INTO ERROR_PROCESO (NUMRUN, RUTINA_ERROR, MENSAJE_ERROR)
         VALUES (P_NUMRUN, 'FN_PUNTAJE_EXPERIENCIA', 'ORA-01403: No se ha encontrado ningún dato');
         RETURN 0;
    WHEN OTHERS THEN
         DECLARE
             v_error_msg VARCHAR2(4000);
         BEGIN
             v_error_msg := SQLERRM;
             INSERT INTO ERROR_PROCESO (NUMRUN, RUTINA_ERROR, MENSAJE_ERROR)
             VALUES (P_NUMRUN, 'FN_PUNTAJE_EXPERIENCIA', v_error_msg);
             RETURN 0;
         END;
END;
/


-----------------------------------------------------
-- FUNCIÓN: FN_PUNTAJE_PAIS
-----------------------------------------------------
CREATE OR REPLACE FUNCTION FN_PUNTAJE_PAIS(
    P_NUMRUN IN VARCHAR2
) RETURN NUMBER IS
   V_PUNTAJE  NUMBER(10);
BEGIN
   BEGIN
      SELECT P.PTJE_PAIS
        INTO V_PUNTAJE
        FROM POSTULACION_PASANTIA_PERFEC PP
             INNER JOIN PASANTIA_PERFECCIONAMIENTO PF ON PP.COD_PROGRAMA = PF.COD_PROGRAMA
             INNER JOIN INSTITUCION I ON PF.COD_INST = I.COD_INST
             INNER JOIN PTJE_PAIS_POSTULA P ON I.COD_PAIS = P.COD_PAIS
       WHERE PP.NUMRUN = P_NUMRUN;
   EXCEPTION
      WHEN NO_DATA_FOUND THEN
         INSERT INTO ERROR_PROCESO(NUMRUN, RUTINA_ERROR, MENSAJE_ERROR)
         VALUES (P_NUMRUN, 'FN_PUNTAJE_PAIS', 'No existe puntaje definido para el NUMRUN=' || P_NUMRUN);
         V_PUNTAJE := 0;
      WHEN OTHERS THEN
         DECLARE
            V_ERROR_MSG VARCHAR2(4000);
         BEGIN
            V_ERROR_MSG := SQLERRM;
            INSERT INTO ERROR_PROCESO(NUMRUN, RUTINA_ERROR, MENSAJE_ERROR)
            VALUES (P_NUMRUN, 'FN_PUNTAJE_PAIS', V_ERROR_MSG);
            V_PUNTAJE := 0;
         END;
   END;
   RETURN V_PUNTAJE;
END;
/



-----------------------------------------------------
-- PROCEDIMIENTO ALMACENADO: PRC_CALCULA_PUNTAJES
-----------------------------------------------------
CREATE OR REPLACE PROCEDURE PRC_CALCULA_PUNTAJES (
    P_PORCENTAJE IN NUMBER 
) IS
    -- Cursor para recorrer los postulantes ordenados por NUMRUN
    CURSOR C_CANDIDATOS IS
        SELECT NUMRUN,
               DVRUN,
               INITCAP(PNOMBRE) || ' ' || INITCAP(NVL(SNOMBRE, '')) || ' ' ||
               INITCAP(APATERNO) || ' ' || INITCAP(AMATERNO) AS NOMBRE_COMPLETO
          FROM ANTECEDENTES_PERSONALES
         ORDER BY NUMRUN;
         
    V_NUMRUN       VARCHAR2(20);
    V_NOMBRE       VARCHAR2(200);
    V_PTJE_EXP     NUMBER(10);
    V_PTJE_PAIS    NUMBER(10);
    V_SUM_HORAS    NUMBER(10);
    V_CANT_ESTAB   NUMBER(10);
    V_PTJE_EXTRA   NUMBER(10);
BEGIN
    -- Limpiar tablas de salida
    EXECUTE IMMEDIATE 'TRUNCATE TABLE DETALLE_PUNTAJE_POSTULACION';
    EXECUTE IMMEDIATE 'TRUNCATE TABLE RESULTADO_POSTULACION';
    EXECUTE IMMEDIATE 'TRUNCATE TABLE ERROR_PROCESO';

    FOR rec IN C_CANDIDATOS LOOP
        -- Formatear el RUN
        V_NUMRUN := FN_FORMAT_RUT(rec.NUMRUN, rec.DVRUN);
        V_NOMBRE := rec.NOMBRE_COMPLETO;
      
        -- Calcular puntajes de experiencia y país
        V_PTJE_EXP  := FN_PUNTAJE_EXPERIENCIA(rec.NUMRUN);
        V_PTJE_PAIS := FN_PUNTAJE_PAIS(rec.NUMRUN);
    
        BEGIN
            -- Obtener suma de horas y cantidad de establecimientos
            SELECT NVL(SUM(HORAS_SEMANALES), 0), NVL(COUNT(*), 0)
              INTO V_SUM_HORAS, V_CANT_ESTAB
              FROM ANTECEDENTES_LABORALES
             WHERE NUMRUN = rec.NUMRUN;
        EXCEPTION
            WHEN NO_DATA_FOUND THEN
                V_SUM_HORAS  := 0;
                V_CANT_ESTAB := 0;
        END;
        
        -- Calcular puntaje extra usando la función del package
        V_PTJE_EXTRA := PKG_PUNTAJE_EXTRA.FN_CALC_PUNTAJE_EXTRA(
                            P_SUMA_PUNTAJES => V_PTJE_EXP + V_PTJE_PAIS,
                            P_HORAS_TOTALES => V_SUM_HORAS,
                            P_NUM_ESTAB     => V_CANT_ESTAB,
                            P_PORCENTAJE    => P_PORCENTAJE
                        );
        -- Guardar en la variable global del package
        PKG_PUNTAJE_EXTRA.V_PUNTAJE_EXTRA := V_PTJE_EXTRA;
    
        -- Insertar la información en DETALLE_PUNTAJE_POSTULACION
        INSERT INTO DETALLE_PUNTAJE_POSTULACION (
            RUN_POSTULANTE,
            NOMBRE_POSTULANTE,
            PTJE_ANNOS_EXP,
            PTJE_PAIS_POSTULA,
            PTJE_EXTRA
        ) VALUES (
            V_NUMRUN,
            V_NOMBRE,
            V_PTJE_EXP,
            V_PTJE_PAIS,
            V_PTJE_EXTRA
        );
    END LOOP;
END;
/


-----------------------------------------------------
-- TRIGGER: TRG_DETALLE_PTJE_POST
-----------------------------------------------------
CREATE OR REPLACE TRIGGER TRG_DETALLE_PTJE_POST
AFTER INSERT ON DETALLE_PUNTAJE_POSTULACION
FOR EACH ROW
DECLARE
    V_PUNTAJE_FINAL NUMBER(10);
    V_RESULTADO     VARCHAR2(20);
BEGIN
    -- Calcular el puntaje final
    V_PUNTAJE_FINAL := :NEW.PTJE_ANNOS_EXP + :NEW.PTJE_PAIS_POSTULA + :NEW.PTJE_EXTRA;
    
    -- Determinar resultado según el puntaje final
    IF V_PUNTAJE_FINAL >= 2500 THEN
        V_RESULTADO := 'SELECCIONADO';
    ELSE
        V_RESULTADO := 'NO SELECCIONADO';
    END IF;
    
    -- Intentar actualizar RESULTADO_POSTULACION
    UPDATE RESULTADO_POSTULACION
       SET PTJE_FINAL_POST = V_PUNTAJE_FINAL,
           RESULTADO_POST  = V_RESULTADO
     WHERE RUN_POSTULANTE = :NEW.RUN_POSTULANTE;
     
    -- Si no se actualizó ningún registro, se inserta uno nuevo
    IF SQL%ROWCOUNT = 0 THEN
        INSERT INTO RESULTADO_POSTULACION (
            RUN_POSTULANTE,
            PTJE_FINAL_POST,
            RESULTADO_POST
        ) VALUES (
            :NEW.RUN_POSTULANTE,
            V_PUNTAJE_FINAL,
            V_RESULTADO
        );
    END IF;
END;
/


-----------------------------------------------------
-- EJECUCIÓN DE PRUEBA: Invocar el procedimiento principal
-----------------------------------------------------
BEGIN
    PRC_CALCULA_PUNTAJES(35);  
END;
/

-----------------------------------------------------
-- CONSULTAS PARA VERIFICAR RESULTADOS
-----------------------------------------------------
SELECT 
    RUN_POSTULANTE AS "RUN_POSTULANTE",
    NOMBRE_POSTULANTE AS "NOMBRE_POSTULANTE",
    PTJE_ANNOS_EXP AS "PTJE_ANNOS_EXP",
    PTJE_PAIS_POSTULA AS "PTJE_PAIS_POSTULA",
    PTJE_EXTRA AS "PTJE_EXTRA"
FROM 
    DETALLE_PUNTAJE_POSTULACION
ORDER BY 
    TO_NUMBER(REPLACE(SUBSTR(RUN_POSTULANTE, 1, INSTR(RUN_POSTULANTE, '-') - 1), '.', ''));

SELECT * 
    FROM RESULTADO_POSTULACION 
    ORDER BY RUN_POSTULANTE;

SELECT * 
    FROM ERROR_PROCESO;








